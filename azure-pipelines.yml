trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- script: echo Hello!
  displayName: 'Running intro'

- task: TerraformTaskV3@3
  inputs:
    provider: 'aws'
    command: 'init'
    workingDirectory: '$(System.DefaultWorkingDirectory)/configuration/iaac/aws/kubernetes'
    backendServiceAWS: 'rbaws'
    backendAWSBucketName: 'rbk8'
    backendAWSKey: 'kubernetes-dev.tfstate'














# stages:
# - stage: Build
#   jobs:
#   - job: BuildJob
#     steps:
#     - bash: echo "Do the build"
#     - bash: echo $(PipelineLevelVariable)
#     - bash: echo $(Build.BuildNumber)
#     - bash: echo $(Build.BuildID)
#     - bash: echo $(Build.SourceBranchName)
#     - bash: echo $(Build.SourcesDirectory)
#     - bash: echo $(System.DefaultWorkingDirectory)
#     - bash: echo $(Build.ArtifactStagingDirectory)
#     - bash: java --version
#     - bash: python --version
#     - bash: ls -R $(Build.ArtifactStagingDirectory)
#     - task: CopyFiles@2
#       inputs:
#         SourceFolder: '$(System.DefaultWorkingDirectory)'
#         Contents: |
#           **/*.yaml
#           **/*.tf
#         TargetFolder: '$(Build.ArtifactStagingDirectory)'
#     - bash: ls -R $(Build.ArtifactStagingDirectory)
#     - task: PublishBuildArtifacts@1
#       inputs:
#         PathtoPublish: '$(Build.ArtifactStagingDirectory)'
#         ArtifactName: 'drop'
#         publishLocation: 'Container'


# - stage: DevDeploy
#   dependsOn: Build
#   jobs:
#   - deployment: DevDeployJob
#     environment: Dev
#     strategy:
#       runOnce:
#         deploy:
#           steps:
#           - script: echo deploy to Dev

# - stage: QADeploy
#   dependsOn: Build
#   jobs:
#   - deployment: QADeployJob
#     environment: QA
#     strategy:
#       runOnce:
#         deploy:
#           steps:
#           - script: echo deploy to QA

# - stage: ProdDeploy
#   dependsOn: Build
#   jobs:
#   - deployment: ProdDeployJob
#     environment: Prod
#     strategy:
#       runOnce:
#         deploy:
#           steps:
#           - script: echo deploy to Prod